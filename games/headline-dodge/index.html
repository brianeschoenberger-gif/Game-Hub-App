<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Headline Dodge</title>
    <style>
      body {
        margin: 0;
        font-family: system-ui, sans-serif;
        background: #020914;
        color: #e8efff;
        display: grid;
        place-items: center;
        min-height: 100vh;
      }
      .wrap {
        width: min(720px, 96vw);
      }
      canvas {
        width: 100%;
        border-radius: 12px;
        background: linear-gradient(#081225, #03070f);
        border: 1px solid rgba(255, 255, 255, 0.12);
      }
      p { color: #9fb2d6; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <h1>Headline Dodge</h1>
      <p>Use ← and → to dodge incoming headline blocks for 30 seconds.</p>
      <canvas id="game" width="720" height="400"></canvas>
      <p id="status"></p>
    </div>
    <script>
      const canvas = document.getElementById('game');
      const ctx = canvas.getContext('2d');
      const statusNode = document.getElementById('status');
      const player = { x: 340, y: 350, w: 40, h: 30, speed: 6 };
      const keys = new Set();
      const obstacles = [];
      let score = 0;
      let lives = 3;
      let frame = 0;

      document.addEventListener('keydown', (e) => keys.add(e.key));
      document.addEventListener('keyup', (e) => keys.delete(e.key));

      function spawn() {
        obstacles.push({ x: Math.random() * 680, y: -40, w: 38, h: 28, speed: 2 + Math.random() * 2 });
      }

      function collide(a, b) {
        return a.x < b.x + b.w && a.x + a.w > b.x && a.y < b.y + b.h && a.y + a.h > b.y;
      }

      function tick() {
        frame += 1;
        if (frame % 30 === 0) spawn();
        if (keys.has('ArrowLeft')) player.x -= player.speed;
        if (keys.has('ArrowRight')) player.x += player.speed;
        player.x = Math.max(0, Math.min(canvas.width - player.w, player.x));

        ctx.clearRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#f8405f';
        ctx.fillRect(player.x, player.y, player.w, player.h);

        for (const obstacle of obstacles) {
          obstacle.y += obstacle.speed;
          ctx.fillStyle = '#9bc1ff';
          ctx.fillRect(obstacle.x, obstacle.y, obstacle.w, obstacle.h);
          if (collide(player, obstacle)) {
            lives -= 1;
            obstacle.y = 500;
          }
          if (obstacle.y > canvas.height) score += 1;
        }

        while (obstacles.length && obstacles[0].y > 500) obstacles.shift();
        statusNode.textContent = `Score: ${score} | Lives: ${lives}`;

        if (lives <= 0) {
          statusNode.textContent += ' — Game over. Refresh to retry.';
          return;
        }
        requestAnimationFrame(tick);
      }

      tick();
    </script>
  </body>
</html>
